<%= will_paginate @all_post %>
<% @all_post.each do |post| %>
  <div class="mb-3 p-3 bg-white rounded shadow-sm">
    <div class="my-3 p-3 bg-white rounded shadow-sm panel-group" id="accordion"">
      <%= link_to picture_for(post.step.roadmap.user), post.step.roadmap.user %>
      <%= link_to post.step.roadmap.user.name, post.step.roadmap.user%>
      <p class="border-bottom border-gray">
        ロードマップ：<%= link_to post.step.roadmap.title, user_roadmap_steps_path(roadmap_id:post.step.roadmap.id,user_id:post.step.roadmap.user.id) %> > ステップ：<%= link_to post.step.name, all_user_roadmap_step_posts_path(step_id: post.step.id,roadmap_id:post.step.roadmap.id,user_id:post.step.roadmap.user.id) %>
      </p>
      <div class="media pt-3 panel panel-default">
        <i class="mr-2 far fa-newspaper fa-2x"></i>
        <div class="media-body pb-3 mb-0 lh-125 border-bottom border-gray panel-heading">
        <% if @all_post.any? %>
          <h4 class="d-block panel-title">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapse-<%= post.id %>">
              <%= post.title %>
            </a>
          </h4>
            <p class="mb-1 text-break border-bottom border-gray">ハッシュタグ：<%= render_with_hashtags_post(post.hashbody) %></p>
            <p class="mb-1 text-break border-bottom border-gray">参考URL：<%= post.url %></p>
            <p class="mb-1 border-bottom border-gray">独学カテゴリー；<%= categorise(post) %></p>
          <div id="collapse-<%= post.id %>" class="panel-collapse collapse in">
            <div class="panel-body">
              <%= post.content %>
            </div>
          </div>
          <% end %>
        </div>
      </div>
      <div class="timestamp text-right">
        作成日：<%= post.created_at.to_s(:datetime) %>
        <% if current_user?(post.step.roadmap.user) %>
          <%= link_to "編集する", edit_user_roadmap_step_post_path(post.id, step_id: post.step.id,roadmap_id:post.step.roadmap.id,user_id:post.step.roadmap.user.id), method: :get,
          data: { confirm: "こちらを編集しますか?" }, data: {"turbolinks" => false} %>
          <%= link_to "削除する", user_roadmap_step_post_path(post.id, step_id: post.step.id,roadmap_id:post.step.roadmap.id,user_id:post.step.roadmap.user.id), method: :delete,
          data: { confirm: "本当に消しますか?" } %>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
<%= will_paginate @all_post %>